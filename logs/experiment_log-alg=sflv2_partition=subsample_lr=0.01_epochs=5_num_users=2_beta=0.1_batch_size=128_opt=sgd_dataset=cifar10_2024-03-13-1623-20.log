03-13 16:23 INFO     cuda
03-13 16:23 INFO     Command Line Arguments: 
{
    "epochs": 5,
    "comm_round": 8,
    "sample_fraction": 1.0,
    "alpha": 0.1,
    "dataset": "cifar10",
    "datadir": "../data/",
    "partition": "subsample",
    "alg": "sflv2",
    "model": "resnet-18",
    "n_parties": 2,
    "lr": 0.01,
    "mu": 1,
    "std_coeff": 2.5,
    "unif_coeff": 0.5,
    "batch_size": 128,
    "load_first_net": 1,
    "pool_option": "FIFO",
    "model_buffer_size": 1,
    "optimizer": "sgd",
    "simp_width": 1,
    "out_dim": 256,
    "reg": 0.0005,
    "temperature": 0.5,
    "logdir": "./",
    "log_file_name": "logs/experiment_log-alg=sflv2_partition=subsample_lr=0.01_epochs=5_num_users=2_beta=0.1_batch_size=128_opt=sgd_dataset=cifar10_2024-03-13-1623-20",
    "seed": 42,
    "device": "cuda",
    "multiprocessing": 0
}
03-13 16:23 INFO     Data statistics: {0: {2: 218, 3: 1079, 4: 996, 6: 6, 7: 460, 8: 1142, 9: 1099}, 1: {0: 1452, 1: 1430, 2: 1162, 3: 1, 4: 193, 5: 1494, 6: 1397, 7: 871}}
03-13 16:23 INFO     in comm round:0
03-13 16:23 INFO     Training network 0 n_training: 5000
03-13 16:23 INFO     Training network 0
03-13 16:23 INFO     n_training: 39
03-13 16:23 INFO     Client: 0 Epoch: 0 Loss: 1.3931714984086843
03-13 16:23 INFO     Client: 0 Epoch: 1 Loss: 1.0307052471698859
03-13 16:23 INFO     Client: 0 Epoch: 2 Loss: 0.9579319755236307
03-13 16:23 INFO     Client: 0 Epoch: 3 Loss: 0.8819469396884625
03-13 16:23 INFO     Client: 0 Epoch: 4 Loss: 0.849756005482796
03-13 16:23 INFO      ** Client: 0 Training complete **
03-13 16:23 INFO     Training network 1 n_training: 8000
03-13 16:23 INFO     Training network 1
03-13 16:23 INFO     n_training: 62
03-13 16:23 INFO     Client: 1 Epoch: 0 Loss: 2.324914853419027
03-13 16:23 INFO     Client: 1 Epoch: 1 Loss: 1.4447459636196014
03-13 16:23 INFO     Client: 1 Epoch: 2 Loss: 1.2528607518442216
03-13 16:23 INFO     Client: 1 Epoch: 3 Loss: 1.120098284175319
03-13 16:23 INFO     Client: 1 Epoch: 4 Loss: 1.0151818798434349
03-13 16:23 INFO      ** Client: 1 Training complete **
03-13 16:23 INFO     global n_training: 390
03-13 16:23 INFO     global n_test: 79
03-13 16:23 INFO     >> Global Model Train accuracy: 0.100561
03-13 16:23 INFO     >> Global Model Test accuracy: 0.101000
03-13 16:23 INFO     >> Global Model Train loss: 4.787530
03-13 16:23 INFO     in comm round:1
03-13 16:23 INFO     Training network 0 n_training: 5000
03-13 16:23 INFO     Training network 0
03-13 16:23 INFO     n_training: 39
03-13 16:23 INFO     Client: 0 Epoch: 0 Loss: 2.7268672631337094
03-13 16:23 INFO     Client: 0 Epoch: 1 Loss: 1.3414735121604724
03-13 16:24 INFO     Client: 0 Epoch: 2 Loss: 1.187814793525598
03-13 16:24 INFO     Client: 0 Epoch: 3 Loss: 1.0548120889908228
03-13 16:24 INFO     Client: 0 Epoch: 4 Loss: 0.988168905942868
03-13 16:24 INFO      ** Client: 0 Training complete **
03-13 16:24 INFO     Training network 1 n_training: 8000
03-13 16:24 INFO     Training network 1
03-13 16:24 INFO     n_training: 62
03-13 16:24 INFO     Client: 1 Epoch: 0 Loss: 1.6844912796251235
03-13 16:24 INFO     Client: 1 Epoch: 1 Loss: 1.0244140057794509
03-13 16:24 INFO     Client: 1 Epoch: 2 Loss: 0.9327319937367593
03-13 16:24 INFO     Client: 1 Epoch: 3 Loss: 0.8702048217096636
03-13 16:24 INFO     Client: 1 Epoch: 4 Loss: 0.8303022538461993
03-13 16:24 INFO      ** Client: 1 Training complete **
03-13 16:24 INFO     global n_training: 390
03-13 16:24 INFO     global n_test: 79
03-13 16:24 INFO     >> Global Model Train accuracy: 0.144752
03-13 16:24 INFO     >> Global Model Test accuracy: 0.151900
03-13 16:24 INFO     >> Global Model Train loss: 2.979504
03-13 16:24 INFO     in comm round:2
03-13 16:24 INFO     Training network 0 n_training: 5000
03-13 16:24 INFO     Training network 0
03-13 16:24 INFO     n_training: 39
03-13 16:24 INFO     Client: 0 Epoch: 0 Loss: 1.5261216469300098
03-13 16:24 INFO     Client: 0 Epoch: 1 Loss: 0.9512052612426953
03-13 16:24 INFO     Client: 0 Epoch: 2 Loss: 0.8180182102398995
03-13 16:24 INFO     Client: 0 Epoch: 3 Loss: 0.7696987665616549
03-13 16:24 INFO     Client: 0 Epoch: 4 Loss: 0.7283645470937093
03-13 16:24 INFO      ** Client: 0 Training complete **
03-13 16:24 INFO     Training network 1 n_training: 8000
03-13 16:24 INFO     Training network 1
03-13 16:24 INFO     n_training: 62
03-13 16:24 INFO     Client: 1 Epoch: 0 Loss: 1.2592436104051528
03-13 16:24 INFO     Client: 1 Epoch: 1 Loss: 0.8697023526314767
03-13 16:24 INFO     Client: 1 Epoch: 2 Loss: 0.8000395346072412
03-13 16:24 INFO     Client: 1 Epoch: 3 Loss: 0.7398875009629035
03-13 16:24 INFO     Client: 1 Epoch: 4 Loss: 0.6793356441682384
03-13 16:24 INFO      ** Client: 1 Training complete **
03-13 16:24 INFO     global n_training: 390
03-13 16:24 INFO     global n_test: 79
03-13 16:24 INFO     >> Global Model Train accuracy: 0.366667
03-13 16:24 INFO     >> Global Model Test accuracy: 0.368000
03-13 16:24 INFO     >> Global Model Train loss: 2.342814
03-13 16:24 INFO     in comm round:3
03-13 16:24 INFO     Training network 0 n_training: 5000
03-13 16:24 INFO     Training network 0
03-13 16:24 INFO     n_training: 39
03-13 16:24 INFO     Client: 0 Epoch: 0 Loss: 1.054047472966023
03-13 16:24 INFO     Client: 0 Epoch: 1 Loss: 0.7513244029803153
03-13 16:24 INFO     Client: 0 Epoch: 2 Loss: 0.6652930929110601
03-13 16:24 INFO     Client: 0 Epoch: 3 Loss: 0.6115628083546957
03-13 16:24 INFO     Client: 0 Epoch: 4 Loss: 0.5884888225641006
03-13 16:24 INFO      ** Client: 0 Training complete **
03-13 16:24 INFO     Training network 1 n_training: 8000
03-13 16:24 INFO     Training network 1
03-13 16:24 INFO     n_training: 62
03-13 16:25 INFO     Client: 1 Epoch: 0 Loss: 0.9463368404296136
03-13 16:25 INFO     Client: 1 Epoch: 1 Loss: 0.7002084288866289
03-13 16:25 INFO     Client: 1 Epoch: 2 Loss: 0.6741156270427089
03-13 16:25 INFO     Client: 1 Epoch: 3 Loss: 0.6163321228757981
03-13 16:25 INFO     Client: 1 Epoch: 4 Loss: 0.590934413575357
03-13 16:25 INFO      ** Client: 1 Training complete **
03-13 16:25 INFO     global n_training: 390
03-13 16:25 INFO     global n_test: 79
03-13 16:25 INFO     >> Global Model Train accuracy: 0.241186
03-13 16:25 INFO     >> Global Model Test accuracy: 0.255700
03-13 16:25 INFO     >> Global Model Train loss: 2.173864
03-13 16:25 INFO     in comm round:4
03-13 16:25 INFO     Training network 0 n_training: 5000
03-13 16:25 INFO     Training network 0
03-13 16:25 INFO     n_training: 39
03-13 16:25 INFO     Client: 0 Epoch: 0 Loss: 0.789215774108202
03-13 16:25 INFO     Client: 0 Epoch: 1 Loss: 0.5933174552061619
03-13 16:25 INFO     Client: 0 Epoch: 2 Loss: 0.5342831963147873
03-13 16:25 INFO     Client: 0 Epoch: 3 Loss: 0.49503359771691835
03-13 16:25 INFO     Client: 0 Epoch: 4 Loss: 0.47267401829744
03-13 16:25 INFO      ** Client: 0 Training complete **
03-13 16:25 INFO     Training network 1 n_training: 8000
03-13 16:25 INFO     Training network 1
03-13 16:25 INFO     n_training: 62
03-13 16:25 INFO     Client: 1 Epoch: 0 Loss: 0.7648738786097495
03-13 16:25 INFO     Client: 1 Epoch: 1 Loss: 0.581049106294109
03-13 16:25 INFO     Client: 1 Epoch: 2 Loss: 0.5401285968480571
03-13 16:25 INFO     Client: 1 Epoch: 3 Loss: 0.5100583991696758
03-13 16:25 INFO     Client: 1 Epoch: 4 Loss: 0.48733722634853854
03-13 16:25 INFO      ** Client: 1 Training complete **
03-13 16:25 INFO     global n_training: 390
03-13 16:25 INFO     global n_test: 79
03-13 16:25 INFO     >> Global Model Train accuracy: 0.476923
03-13 16:25 INFO     >> Global Model Test accuracy: 0.471700
03-13 16:25 INFO     >> Global Model Train loss: 1.915036
03-13 16:25 INFO     in comm round:5
03-13 16:25 INFO     Training network 0 n_training: 5000
03-13 16:25 INFO     Training network 0
03-13 16:25 INFO     n_training: 39
03-13 16:25 INFO     Client: 0 Epoch: 0 Loss: 0.7525348243040916
03-13 16:25 INFO     Client: 0 Epoch: 1 Loss: 0.46227925633772826
03-13 16:25 INFO     Client: 0 Epoch: 2 Loss: 0.4371023277441661
03-13 16:25 INFO     Client: 0 Epoch: 3 Loss: 0.41601357857386273
03-13 16:25 INFO     Client: 0 Epoch: 4 Loss: 0.40600894620785344
03-13 16:25 INFO      ** Client: 0 Training complete **
03-13 16:25 INFO     Training network 1 n_training: 8000
03-13 16:25 INFO     Training network 1
03-13 16:25 INFO     n_training: 62
03-13 16:25 INFO     Client: 1 Epoch: 0 Loss: 0.6365462257977454
03-13 16:25 INFO     Client: 1 Epoch: 1 Loss: 0.5009903975071446
03-13 16:26 INFO     Client: 1 Epoch: 2 Loss: 0.4476717374017162
03-13 16:26 INFO     Client: 1 Epoch: 3 Loss: 0.4307125715478774
03-13 16:26 INFO     Client: 1 Epoch: 4 Loss: 0.41091254930342397
03-13 16:26 INFO      ** Client: 1 Training complete **
03-13 16:26 INFO     global n_training: 390
03-13 16:26 INFO     global n_test: 79
03-13 16:26 INFO     >> Global Model Train accuracy: 0.438101
03-13 16:26 INFO     >> Global Model Test accuracy: 0.460400
03-13 16:26 INFO     >> Global Model Train loss: 1.580708
03-13 16:26 INFO     in comm round:6
03-13 16:26 INFO     Training network 0 n_training: 5000
03-13 16:26 INFO     Training network 0
03-13 16:26 INFO     n_training: 39
03-13 16:26 INFO     Client: 0 Epoch: 0 Loss: 0.5115288029878567
03-13 16:26 INFO     Client: 0 Epoch: 1 Loss: 0.38175786038239795
03-13 16:26 INFO     Client: 0 Epoch: 2 Loss: 0.36084199028137404
03-13 16:26 INFO     Client: 0 Epoch: 3 Loss: 0.32700134126039654
03-13 16:26 INFO     Client: 0 Epoch: 4 Loss: 0.32092756300400466
03-13 16:26 INFO      ** Client: 0 Training complete **
03-13 16:26 INFO     Training network 1 n_training: 8000
03-13 16:26 INFO     Training network 1
03-13 16:26 INFO     n_training: 62
03-13 16:26 INFO     Client: 1 Epoch: 0 Loss: 0.6066542746078584
03-13 16:26 INFO     Client: 1 Epoch: 1 Loss: 0.42961099142989806
03-13 16:26 INFO     Client: 1 Epoch: 2 Loss: 0.3821819958186919
03-13 16:26 INFO     Client: 1 Epoch: 3 Loss: 0.3746789201132713
03-13 16:26 INFO     Client: 1 Epoch: 4 Loss: 0.3560671313635765
03-13 16:26 INFO      ** Client: 1 Training complete **
03-13 16:26 INFO     global n_training: 390
03-13 16:26 INFO     global n_test: 79
03-13 16:26 INFO     >> Global Model Train accuracy: 0.526763
03-13 16:26 INFO     >> Global Model Test accuracy: 0.527000
03-13 16:26 INFO     >> Global Model Train loss: 2.792093
03-13 16:26 INFO     in comm round:7
03-13 16:26 INFO     Training network 0 n_training: 5000
03-13 16:26 INFO     Training network 0
03-13 16:26 INFO     n_training: 39
03-13 16:26 INFO     Client: 0 Epoch: 0 Loss: 0.918462648605689
03-13 16:26 INFO     Client: 0 Epoch: 1 Loss: 0.381088171631862
03-13 16:26 INFO     Client: 0 Epoch: 2 Loss: 0.33869405511098033
03-13 16:26 INFO     Client: 0 Epoch: 3 Loss: 0.3178460662945723
03-13 16:26 INFO     Client: 0 Epoch: 4 Loss: 0.29575315270668423
03-13 16:26 INFO      ** Client: 0 Training complete **
03-13 16:26 INFO     Training network 1 n_training: 8000
03-13 16:26 INFO     Training network 1
03-13 16:26 INFO     n_training: 62
03-13 16:26 INFO     Client: 1 Epoch: 0 Loss: 0.5275054944138373
03-13 16:26 INFO     Client: 1 Epoch: 1 Loss: 0.37705948540279943
03-13 16:26 INFO     Client: 1 Epoch: 2 Loss: 0.3409575553190324
03-13 16:26 INFO     Client: 1 Epoch: 3 Loss: 0.31815181552402433
03-13 16:27 INFO     Client: 1 Epoch: 4 Loss: 0.297322959909516
03-13 16:27 INFO      ** Client: 1 Training complete **
03-13 16:27 INFO     global n_training: 390
03-13 16:27 INFO     global n_test: 79
03-13 16:27 INFO     >> Global Model Train accuracy: 0.449639
03-13 16:27 INFO     >> Global Model Test accuracy: 0.456800
03-13 16:27 INFO     >> Global Model Train loss: 1.526458
03-13 16:27 INFO     Starting Fine Tuning...
03-13 16:27 INFO     Training network 0
03-13 16:27 INFO     n_training: 39
03-13 16:27 INFO     Client: 0 Epoch: 0 Loss: 0.31207284254905504
03-13 16:27 INFO     Client: 0 Epoch: 1 Loss: 0.26792915853170246
03-13 16:27 INFO     Client: 0 Epoch: 2 Loss: 0.2480781907454515
03-13 16:27 INFO     Client: 0 Epoch: 3 Loss: 0.2447591706728324
03-13 16:27 INFO     Client: 0 Epoch: 4 Loss: 0.2135244648043926
03-13 16:27 INFO      ** Client: 0 Training complete **
